{"version":3,"sources":["webpack:///./src/views/Restaurants.vue?1ab2","webpack:///./src/views/Restaurants.vue?de67","webpack:///src/views/Restaurants.vue","webpack:///./src/views/Restaurants.vue?6956","webpack:///./src/views/Restaurants.vue?d838"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","class","modalShow","showModal","on","$event","$router","push","_e","_m","filter","length","ref","_v","_s","resultCount","districtsFilter","showChangeModal","categoriesFilter","showAddModal","priceFilter","showPriceModal","restaurants","_l","pageNum","key","Math","ceil","slice","cardPerDeck","deckNum","item","idx","style","stopPropagation","isFavorited","deleteFavorite","Number","id","addFavorite","rating","padEnd","CommentsCount","name","Category","District","description","average_consumption","noMoreData","fetchRestaurants","attrs","closeFilter","completeAdding","completeChanging","completePricing","staticRenderFns","data","scrollY","scrollUp","divHeight","scrollBarHeight","windowWidth","window","innerWidth","numOfPage","priceQueryString","components","Navbar","Footer","FilterModal","AddCategory","ChangeDistrict","PriceRange","created","Object","keys","$route","query","constructor","category","district","mounted","$refs","addEventListener","onScroll","scrollHeight","clientHeight","defineCardDeck","watch","computed","methods","isEditing","cateFilter","distFilter","pFilter","scrollTop","isAdding","isChanging","isPricing","component"],"mappings":"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","file":"js/chunk-2fb89c0c.6317eb9c.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Restaurants.vue?vue&type=style&index=0&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"restaurants\",class:{modalShow: _vm.showModal}},[_c('Navbar',{staticClass:\"restaurant-navbar\"}),_c('div',{staticClass:\"searchbar-wrapper-mobile\"},[_c('div',{staticClass:\"back-wrapper\",on:{\"click\":function($event){return _vm.$router.push('/map')}}},[_c('div',{staticClass:\"icon back\"})]),_c('div',{staticClass:\"searchbar\"},[(false)?_c('input',{staticClass:\"search-input\"}):_vm._e(),_vm._m(0)]),_c('div',{staticClass:\"filter-wrapper\",class:{ 'filter-on': _vm.filter.length > 1 },on:{\"click\":function($event){_vm.showModal = !_vm.showModal}}},[_c('div',{staticClass:\"icon filter\"})])]),_c('div',{ref:\"list-container\",staticClass:\"list-container\"},[_c('div',{ref:\"restaurant-list\",staticClass:\"restaurant-list\"},[_c('div',{staticClass:\"title\"},[_c('div',{staticClass:\"result-count\"},[_vm._v(_vm._s(_vm.resultCount > 1000 ? '超過1,000' : _vm.resultCount)+\"間餐廳\")]),_vm._v(\" 台北市各地的餐廳 \")]),_c('div',{staticClass:\"filter-button-wrapper\"},[_c('div',{staticClass:\"filter-button\",class:{ 'filter-on': _vm.districtsFilter.length > 0 },on:{\"click\":function($event){_vm.showChangeModal = !_vm.showChangeModal}}},[_vm._v(\"地區\")]),_c('div',{staticClass:\"filter-button\",class:{ 'filter-on': _vm.categoriesFilter.length > 0 },on:{\"click\":function($event){_vm.showAddModal = !_vm.showAddModal}}},[_vm._v(\"類型\")]),_c('div',{staticClass:\"filter-button\",class:{ 'filter-on': _vm.priceFilter.length === 2 },on:{\"click\":function($event){_vm.showPriceModal = !_vm.showPriceModal}}},[_vm._v(\"預算\")])]),(_vm.restaurants.length === 0)?_c('div',{staticClass:\"restaurant-card-deck-wrapper no-restaurant\"}):_vm._e(),(_vm.restaurants.length > 0)?_c('div',{staticClass:\"restaurant-card-deck-wrapper\"},_vm._l((_vm.numOfPage),function(pageNum){return _c('div',{key:(\"page-num-\" + pageNum)},_vm._l((Math.ceil(_vm.restaurants.slice((pageNum - 1) * 24, pageNum * 24).length/_vm.cardPerDeck)),function(deckNum){return _c('div',{key:(\"deck-num-\" + deckNum),staticClass:\"restaurant-card-deck\"},_vm._l((_vm.restaurants.slice((pageNum - 1) * 24, pageNum * 24).slice((deckNum - 1) * _vm.cardPerDeck, deckNum * _vm.cardPerDeck)),function(item,idx){return _c('div',{key:idx,staticClass:\"restaurant-card\",class:{ 'last-card': idx === _vm.cardPerDeck},style:((\"flex: \" + (1/_vm.cardPerDeck))),on:{\"click\":function($event){return _vm.$router.push((\"/restaurants/\" + (item.id)))}}},[_c('div',{staticClass:\"card-image-wrapper\"},[(_vm.isAuthenticated)?_c('div',{staticClass:\"heart-wrapper\",on:{\"click\":function($event){$event.stopPropagation();item.isFavorited ? _vm.deleteFavorite(Number(item.id)) : _vm.addFavorite(Number(item.id))}}},[_c('div',{staticClass:\"icon heart\",class:{ isFavorited: item.isFavorited }})]):_vm._e(),_c('div',{staticClass:\"card-image\",style:((\"background: url(\" + (item.picture) + \") no-repeat center / cover\"))})]),_c('div',{staticClass:\"rating-wrapper\"},[_c('svg',{staticClass:\"icon star\"}),_c('div',{staticClass:\"rating\"},[_c('span',{staticClass:\"number\"},[_c('span',[_vm._v(_vm._s(item.rating.padEnd(3, '.0')))])]),_c('span',{staticClass:\"count\"},[_c('span',[_vm._v(\"(\"+_vm._s(item.CommentsCount)+\")\")])])])]),_c('div',{staticClass:\"name\"},[_vm._v(_vm._s(item.name))]),_c('div',{staticClass:\"category-wrapper\"},[(item.Category)?_c('span',{staticClass:\"category\"},[_vm._v(_vm._s(item.Category.name))]):_vm._e(),_c('span',{staticClass:\"bullet\"},[_vm._v(\"·\")]),(item.District)?_c('span',{staticClass:\"district\"},[_vm._v(_vm._s(item.District.name))]):_vm._e()]),_c('div',{staticClass:\"description\"},[_vm._v(_vm._s(item.description))]),(item.average_consumption)?_c('div',{staticClass:\"expense\"},[_vm._v(\"$\"+_vm._s(item.average_consumption)+\" / 人\")]):_vm._e()])}),0)}),0)}),0):_vm._e(),_c('div',{staticClass:\"load-more\"},[(!_vm.noMoreData && _vm.restaurants.length > 0 && _vm.restaurants.length % 24 === 0)?_c('div',{staticClass:\"load-more-button\",on:{\"click\":function($event){return _vm.fetchRestaurants(_vm.filter)}}},[_vm._v(\"載入更多結果\")]):_vm._e()])]),_c('div',{ref:\"footer\"},[_c('Footer')],1)]),_c('FilterModal',{attrs:{\"showModal\":_vm.showModal,\"categoriesFilter\":_vm.categoriesFilter,\"districtsFilter\":_vm.districtsFilter,\"priceFilter\":_vm.priceFilter},on:{\"closeModal\":_vm.closeFilter}}),_c('AddCategory',{attrs:{\"showModal\":_vm.showAddModal,\"categoriesFilter\":_vm.categoriesFilter},on:{\"closeAddModal\":_vm.completeAdding}}),_c('ChangeDistrict',{attrs:{\"showModal\":_vm.showChangeModal,\"districtsFilter\":_vm.districtsFilter},on:{\"closeChangeModal\":_vm.completeChanging}}),_c('PriceRange',{attrs:{\"showModal\":_vm.showPriceModal,\"priceFilter\":_vm.priceFilter},on:{\"closePriceModal\":_vm.completePricing}})],1)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrapper\"},[_c('div',{staticClass:\"text\"},[_vm._v(\"地圖搜尋\")])])}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"restaurants\" :class=\"{modalShow: showModal}\">\n    <Navbar class=\"restaurant-navbar\"></Navbar>\n    <div class=\"searchbar-wrapper-mobile\">\n      <div class=\"back-wrapper\" @click=\"$router.push('/map')\">\n        <div class=\"icon back\"></div>\n      </div>\n      <div class=\"searchbar\">\n        <input v-if=\"false\" class=\"search-input\">\n        <div class=\"wrapper\">\n          <div class=\"text\">地圖搜尋</div>\n        </div>\n      </div>\n      <div class=\"filter-wrapper\" :class=\"{ 'filter-on': filter.length > 1 }\" @click=\"showModal = !showModal\">\n        <div class=\"icon filter\"></div>\n      </div>\n    </div>\n    <div class=\"list-container\" ref=\"list-container\">\n      <div class=\"restaurant-list\" ref=\"restaurant-list\">\n        <div class=\"title\">\n          <div class=\"result-count\">{{ resultCount > 1000 ? '超過1,000' : resultCount }}間餐廳</div>\n          台北市各地的餐廳\n        </div>\n        <div class=\"filter-button-wrapper\">\n          <div class=\"filter-button\" :class=\"{ 'filter-on': districtsFilter.length > 0 }\" @click=\"showChangeModal = !showChangeModal\">地區</div>\n          <div class=\"filter-button\" :class=\"{ 'filter-on': categoriesFilter.length > 0 }\" @click=\"showAddModal = !showAddModal\">類型</div>\n          <div class=\"filter-button\" :class=\"{ 'filter-on': priceFilter.length === 2 }\" @click=\"showPriceModal = !showPriceModal\">預算</div>\n        </div>\n        <div class=\"restaurant-card-deck-wrapper no-restaurant\" v-if=\"restaurants.length === 0\"></div>\n        <div v-if=\"restaurants.length > 0\" class=\"restaurant-card-deck-wrapper\">\n          <div v-for=\"pageNum in numOfPage\" :key=\"`page-num-${pageNum}`\">\n            <div class=\"restaurant-card-deck\" v-for=\"deckNum in Math.ceil(restaurants.slice((pageNum - 1) * 24, pageNum * 24).length/cardPerDeck)\" :key=\"`deck-num-${deckNum}`\">\n              <div class=\"restaurant-card\"\n                v-for=\"(item, idx) in restaurants.slice((pageNum - 1) * 24, pageNum * 24).slice((deckNum - 1) * cardPerDeck, deckNum * cardPerDeck)\"\n                :key=\"idx\" :class=\"{ 'last-card': idx === cardPerDeck}\"\n                @click=\"$router.push(`/restaurants/${item.id}`)\"\n                :style=\"`flex: ${1/cardPerDeck}`\"\n              >\n                <div class=\"card-image-wrapper\">\n                  <div class=\"heart-wrapper\" v-if=\"isAuthenticated\" @click.stop=\"item.isFavorited ? deleteFavorite(Number(item.id)) : addFavorite(Number(item.id))\">\n                    <div class=\"icon heart\" :class=\"{ isFavorited: item.isFavorited }\"></div>\n                  </div>\n                  <div class=\"card-image\" :style=\"`background: url(${item.picture}) no-repeat center / cover`\"></div>\n                </div>\n                <div class=\"rating-wrapper\">\n                  <svg class=\"icon star\"></svg>\n                  <div class=\"rating\">\n                    <span class=\"number\"><span>{{ item.rating.padEnd(3, '.0') }}</span></span>\n                    <span class=\"count\"><span>({{ item.CommentsCount }})</span></span>\n                  </div>\n                </div>\n                <div class=\"name\">{{ item.name }}</div>\n                <div class=\"category-wrapper\">\n                  <span v-if=\"item.Category\" class=\"category\">{{ item.Category.name }}</span>\n                  <span class=\"bullet\">·</span>\n                  <span v-if=\"item.District\" class=\"district\">{{ item.District.name }}</span>\n                </div>\n                <div class=\"description\">{{ item.description }}</div>\n                <div class=\"expense\" v-if=\"item.average_consumption\">${{ item.average_consumption }} / 人</div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"load-more\">\n          <div class=\"load-more-button\" v-if=\"!noMoreData && restaurants.length > 0 && restaurants.length % 24 === 0\" @click=\"fetchRestaurants(filter)\">載入更多結果</div>\n        </div>\n      </div>\n      <div ref=\"footer\">\n        <Footer></Footer>\n      </div>\n    </div>\n    <FilterModal\n      :showModal=\"showModal\"\n      @closeModal=\"closeFilter\"\n      :categoriesFilter = categoriesFilter\n      :districtsFilter = districtsFilter\n      :priceFilter = priceFilter\n    >\n    </FilterModal>\n    <AddCategory\n      :showModal=\"showAddModal\"\n      @closeAddModal=\"completeAdding\"\n      :categoriesFilter = categoriesFilter\n    >\n    </AddCategory>\n    <ChangeDistrict\n      :showModal=\"showChangeModal\"\n      @closeChangeModal=\"completeChanging\"\n      :districtsFilter = districtsFilter\n    >\n    </ChangeDistrict>\n    <PriceRange\n      :showModal=\"showPriceModal\"\n      @closePriceModal=\"completePricing\"\n      :priceFilter = priceFilter\n    >\n    </PriceRange>\n  </div>\n</template>\n\n<script>\n\nimport { Toast } from '@/utils/helpers'\nimport { mapState } from 'vuex'\nimport restaurantsAPI from '@/apis/restaurants'\nimport usersAPI from '@/apis/users'\nimport Navbar from '@/components/Navbar.vue'\nimport Footer from '@/components/Footer.vue'\nimport FilterModal from '@/components/Filter.vue'\nimport AddCategory from '@/components/AddCategory.vue'\nimport ChangeDistrict from '@/components/ChangeDistrict.vue'\nimport PriceRange from '@/components/PriceRange.vue'\n\nexport default {\n  data () {\n    return {\n      showModal: false,\n      scrollY: 0,\n      scrollUp: true,\n      divHeight: 0,\n      scrollBarHeight: 0,\n      windowWidth: window.innerWidth,\n      cardPerDeck: 1,\n      restaurants: [],\n      numOfPage: 0,\n      filter: [''],\n      showAddModal: false,\n      showChangeModal: false,\n      showPriceModal: false,\n      categoriesFilter: [],\n      districtsFilter: [],\n      priceFilter: [],\n      priceQueryString: [],\n      noMoreData: false,\n      resultCount: 0\n    }\n  },\n  components: {\n    Navbar,\n    Footer,\n    FilterModal,\n    AddCategory,\n    ChangeDistrict,\n    PriceRange\n  },\n  created () {\n    if (!(Object.keys(this.$route.query).length === 0 && this.$route.query.constructor === Object)) {\n      if (this.$route.query.category && this.$route.query.district) {\n        this.categoriesFilter = typeof this.$route.query.category === 'string' ? [this.$route.query.category] : [...this.$route.query.category]\n        this.districtsFilter = typeof this.$route.query.district === 'string' ? [this.$route.query.district] : [...this.$route.query.district]\n        this.filter = ['', ...this.categoriesFilter.map(item => 'category=' + item), ...this.districtsFilter.map(item => 'district=' + item)]\n      } else if (this.$route.query.category && !this.$route.query.district) {\n        this.categoriesFilter = typeof this.$route.query.category === 'string' ? [this.$route.query.category] : [...this.$route.query.category]\n        this.filter = ['', ...this.categoriesFilter.map(item => 'category=' + item)]\n      } else if (!this.$route.query.category && this.$route.query.district) {\n        this.districtsFilter = typeof this.$route.query.district === 'string' ? [this.$route.query.district] : [...this.$route.query.district]\n        this.filter = ['', ...this.districtsFilter.map(item => 'district=' + item)]\n      }\n    } else {\n      this.fetchRestaurants()\n    }\n  },\n  mounted () {\n    this.$refs['list-container'].addEventListener('scroll', this.onScroll, { passive: true })\n    this.divHeight = this.$refs['list-container'].scrollHeight\n    this.scrollBarHeight = this.$refs['list-container'].clientHeight\n    window.addEventListener('resize', () => {\n      this.windowWidth = window.innerWidth\n    })\n    this.defineCardDeck()\n  },\n  watch: {\n    windowWidth () {\n      this.defineCardDeck()\n    }\n  },\n  computed: {\n    ...mapState(['currentUser', 'isAuthenticated'])\n  },\n  methods: {\n    closeFilter (isEditing, cateFilter, distFilter, pFilter) {\n      this.showModal = false\n      if (isEditing) {\n        this.categoriesFilter = cateFilter\n        this.districtsFilter = distFilter\n        this.priceFilter = pFilter\n        if (this.priceFilter.length === 2) {\n          this.priceQueryString[0] = `min=${this.priceFilter[0]}`\n          this.priceQueryString[1] = `max=${this.priceFilter[1]}`\n        } else {\n          this.priceQueryString = []\n        }\n        this.filter = ['', ...this.priceQueryString, ...this.categoriesFilter.map(item => 'category=' + item), ...this.districtsFilter.map(item => 'district=' + item)]\n        this.restaurants = []\n        this.numOfPage = 0\n        this.fetchRestaurants(this.filter)\n      }\n    },\n    onScroll (e) {\n      this.scrollUp = this.scrollY > this.$refs['list-container'].scrollTop\n      this.scrollY = this.$refs['list-container'].scrollTop\n    },\n    defineCardDeck () {\n      if (this.windowWidth < 768) {\n        this.cardPerDeck = 1\n      } else if (this.windowWidth < 992) {\n        this.cardPerDeck = 2\n      } else if (this.windowWidth < 1200) {\n        this.cardPerDeck = 3\n      } else {\n        this.cardPerDeck = 4\n      }\n    },\n    async fetchRestaurants (filter) {\n      try {\n        const { data } = this.isAuthenticated ? await restaurantsAPI.getUsersRestaurants(this.numOfPage + 1, filter) : await restaurantsAPI.getRestaurants(this.numOfPage + 1, filter)\n        this.noMoreData = data.data.length === 0\n        this.restaurants = [...this.restaurants, ...data.data]\n        this.numOfPage += 1\n        this.resultCount = data.count\n      } catch (error) {\n        console.log(error)\n        Toast.fire({\n          icon: 'error',\n          title: '目前無法取得餐廳，請稍候'\n        })\n      }\n    },\n    completeAdding (isAdding, filter) {\n      this.showAddModal = false\n      if (isAdding) {\n        this.categoriesFilter = filter\n        this.filter = ['', ...this.priceQueryString, ...this.categoriesFilter.map(item => 'category=' + item), ...this.districtsFilter.map(item => 'district=' + item)]\n        this.restaurants = []\n        this.numOfPage = 0\n        this.fetchRestaurants(this.filter)\n      }\n    },\n    completeChanging (isChanging, filter) {\n      this.showChangeModal = false\n      if (isChanging) {\n        this.districtsFilter = filter\n        this.filter = ['', ...this.priceQueryString, ...this.categoriesFilter.map(item => 'category=' + item), ...this.districtsFilter.map(item => 'district=' + item)]\n        this.restaurants = []\n        this.numOfPage = 0\n        this.fetchRestaurants(this.filter)\n      }\n    },\n    completePricing (isPricing, filter) {\n      this.showPriceModal = false\n      if (isPricing) {\n        this.restaurants = []\n        this.numOfPage = 1\n        this.priceFilter = filter\n        if (this.priceFilter.length === 2) {\n          this.priceQueryString[0] = `min=${this.priceFilter[0]}`\n          this.priceQueryString[1] = `max=${this.priceFilter[1]}`\n        } else {\n          this.priceQueryString = []\n        }\n        this.filter = ['', ...this.priceQueryString, ...this.categoriesFilter.map(item => 'category=' + item), ...this.districtsFilter.map(item => 'district=' + item)]\n        this.restaurants = []\n        this.numOfPage = 0\n        this.fetchRestaurants(this.filter)\n      }\n    },\n    async addFavorite (id) {\n      try {\n        const { data } = await usersAPI.addFavorite(id)\n        if (data.status !== 'success') {\n          throw new Error(data.message)\n        }\n        this.restaurants.forEach(restaurant => {\n          if (restaurant.id === id) {\n            restaurant.isFavorited = true\n          }\n        })\n        Toast.fire({\n          icon: 'success',\n          title: '已加入收藏'\n        })\n      } catch (error) {\n        console.log(error)\n        Toast.fire({\n          icon: 'error',\n          title: '目前無法收藏餐廳，請稍後'\n        })\n      }\n    },\n    async deleteFavorite (id) {\n      try {\n        const { data } = await usersAPI.deleteFavorite(id)\n        if (data.status !== 'success') {\n          throw new Error(data.message)\n        }\n        this.restaurants.forEach(restaurant => {\n          if (restaurant.id === id) {\n            restaurant.isFavorited = false\n          }\n        })\n        Toast.fire({\n          icon: 'success',\n          title: '已移除收藏'\n        })\n      } catch (error) {\n        console.log(error)\n        Toast.fire({\n          icon: 'error',\n          title: '目前無法取消收藏餐廳，請稍後'\n        })\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n$yellow: #F5DF4D;\n$ultimategray: #939597;\n$divider: #E6ECF0;\n$red: rgb(255, 56, 92);\n.restaurants {\n  width: 100%;\n  position: relative;\n  .searchbar-wrapper-mobile {\n    box-shadow: rgba(0, 0, 0, 0.16) 0px -2px 8px;\n    z-index: 998;\n    background: none;\n    position: sticky;\n    height: 60px;\n    width: 100%;\n    top: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background: #ffffff;\n    @media (min-width: 768px) {\n      display: none;\n    }\n    .back-wrapper {\n      padding-left: 8px;\n      width: 40px;\n      height: 48px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      .icon.back {\n        margin: auto;\n        height: 16px;\n        width: 16px;\n        background-color: #000000;\n        mask: url(../assets/back.svg) no-repeat center;\n      }\n    }\n    .searchbar {\n      background: #ffffff;\n      width: 100%;\n      border-radius: 100px;\n      height: 48px;\n      display: flex;\n      justify-content: flex-start;\n      align-items: center;\n      .search-input {\n        border: none;\n        &:focus {\n          outline: none;\n        }\n      }\n      .wrapper {\n        border-right: 1px solid $divider;\n        width: 100%;\n        display: flex;\n        flex-direction: row;\n        line-height: 18px;\n        .icon {\n          margin: auto 0;\n          padding-right: 8px;\n          background-color: $ultimategray;\n          height: 16px;\n          width: 16px;\n        }\n        .icon.search {\n          mask: url(../assets/search.svg) no-repeat center;\n        }\n        .text {\n          font-size: 14px;\n          font-weight: 600;\n        }\n      }\n    }\n    .filter-wrapper {\n      padding-right: 8px;\n      width: 40px;\n      height: 48px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      position: relative;\n      .icon.filter {\n        margin: auto;\n        height: 16px;\n        width: 16px;\n        background-color: #000000;\n        mask: url(../assets/filter.svg) no-repeat center;\n      }\n    }\n    .filter-wrapper.filter-on:after {\n      background-color: $red;\n      border-radius: 50%;\n      content: \"\";\n      height: 6px;\n      width: 6px;\n      left: 50%;\n      position: absolute;\n      top: 8px;\n    }\n  }\n  .list-container {\n    position: absolute;\n    top: 60px;\n    width: 100%;\n    height: calc(100vh - 60px);\n    overflow: scroll;\n    @media (min-width: 768px) {\n      top: 81px;\n      height: calc(100vh - 81px);\n    }\n    .restaurant-list {\n      margin: 22px 0;\n      padding: 0 24px;\n      @media (min-width: 768px) {\n        padding: 0 40px;\n        margin: 32px auto;\n      }\n      @media (min-width: 992px) {\n        padding: 0 80px;\n        max-width: 1440px;\n      }\n      .title {\n        font-size: 22px;\n        font-weight: 700;\n        text-align: left;\n        line-height: 22px;\n        @media (min-width: 768px) {\n          padding-top: 36px;\n          font-size: 26px;\n          line-height: 30px;\n        }\n        @media (min-width: 992px) {\n          padding-top: 50px;\n          font-size: 32px;\n          line-height: 36px;\n        }\n        .result-count {\n          font-size: 14px;\n          line-height: 18px;\n          padding-bottom: 8px;\n          font-weight: 400;\n        }\n      }\n      .filter-button-wrapper {\n        display: none;\n        @media (min-width: 768px) {\n          display: flex;\n          flex-direction: row;\n          margin: 24px 0;\n        }\n        .filter-button {\n          cursor: pointer;\n          margin-right: 16px;\n          border: 1px solid $divider;\n          font-size: 14px;\n          font-weight: 400;\n          padding: 8px 16px;\n          border-radius: 30px;\n          &:hover {\n            font-weight: 800;\n            border: 1px solid #000000;\n            transition: ease-in-out 0.3s;\n          }\n        }\n        .filter-button.filter-on {\n          font-weight: 800;\n          border: 1px solid #000000;\n          background: rgb(247, 247, 247);\n        }\n      }\n      .restaurant-card-deck-wrapper {\n        min-height: 600px;\n        .restaurant-card-deck {\n          width: 100%;\n          @media (min-width: 768px) {\n            display: flex;\n            flex-direction: row;\n          }\n          .restaurant-card {\n            cursor: pointer;\n            flex: 1;\n            padding-top: 12px;\n            margin-bottom: 28px;\n            @media (min-width: 768px) {\n              margin-right: 16px;\n            }\n            .card-image-wrapper {\n              .heart-wrapper {\n                z-index: 1;\n                position: absolute;\n                top: 0;\n                right: 0;\n                padding-right: 8px;\n                width: 40px;\n                height: 48px;\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                .icon.heart {\n                  cursor: pointer;\n                  margin: auto;\n                  height: 24px;\n                  width: 24px;\n                  background: url(../assets/black-heart.svg) no-repeat center;\n                  background-size: cover;\n                }\n                .icon.heart.isFavorited {\n                  background: url(../assets/red-heart.svg) no-repeat center;\n                  background-size: cover;\n                }\n              }\n              margin-bottom: 10px;\n              padding-top: 66.7%;\n              position: relative;\n              .card-image {\n                position: absolute;\n                top: 0;\n                left: 0;\n                right: 0;\n                bottom: 0;\n                width: 100%;\n                border-radius: 16px;\n                background: url(https://images.unsplash.com/photo-1512058564366-18510be2db19?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1352&q=80) no-repeat center;\n                background-size: cover !important;\n              }\n            }\n            .rating-wrapper {\n              margin-bottom: 6px;\n              width: 100%;\n              font-size: 14px;\n              font-weight: 500;\n              display: flex;\n              flex-direction: row;\n              justify-content: flex-start;\n              align-items: center;\n              line-height: 18px;\n              .icon {\n                margin: auto 0;\n                margin-right: 4px;\n                background-color: $red;\n                height: 14px;\n                width: 14px;\n              }\n              .icon.star {\n                mask: url(../assets/star.svg) no-repeat center;\n              }\n              .rating {\n                display: flex;\n                flex-direction: row;\n                .number {\n                  height: 18px;\n                  margin-right: 4px;\n                  display: flex;\n                  align-items: center;\n                  span {\n                    height: 14px;\n                  }\n                }\n                .count {\n                  height: 18px;\n                  display: flex;\n                  align-items: center;\n                  span {\n                    height: 14px;\n                  }\n                }\n              }\n            }\n            .name {\n              margin-bottom: 6px;\n              font-weight: 800;\n              text-align: left;\n              font-size: 18px;\n              line-height: 22px;\n              overflow: hidden;\n              text-overflow: ellipsis;\n              display: -webkit-box !important;\n              -webkit-line-clamp: 1 !important;\n              -webkit-box-orient: vertical !important;\n            }\n            .category-wrapper {\n              margin-bottom: 4px;\n              text-align: left;\n              font-size: 16px;\n              line-height: 20px;\n              .bullet {\n                margin: 0 4px;\n              }\n            }\n            .description {\n              margin-bottom: 8px;\n              text-align: left;\n              font-size: 16px;\n              line-height: 20px;\n              overflow: hidden;\n              text-overflow: ellipsis;\n              display: -webkit-box !important;\n              -webkit-line-clamp: 1 !important;\n              -webkit-box-orient: vertical !important;\n            }\n            .expense {\n              margin-bottom: 4px;\n              text-align: left;\n              font-weight: 800;\n              font-size: 16px;\n              line-height: 20px;\n            }\n          }\n          .restaurant-card.last-card {\n            @media (min-width: 768px) {\n              margin-right: 0;\n            }\n          }\n        }\n      }\n      .load-more {\n        width: 100%;\n        margin: 80px 0 80px;\n        .load-more-button {\n          cursor: pointer;\n          width: auto;\n          margin: auto;\n          padding: 14px 24px;\n          border-radius: 8px;\n          background: #000000;\n          font-size: 16px;\n          line-height: 20px;\n          font-weight: 600;\n          color: #ffffff;\n          display: inline-block;\n        }\n      }\n    }\n  }\n}\n.restaurants.modalShow {\n  height: 100vh;\n  overflow: hidden;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Restaurants.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Restaurants.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Restaurants.vue?vue&type=template&id=54b5d857&\"\nimport script from \"./Restaurants.vue?vue&type=script&lang=js&\"\nexport * from \"./Restaurants.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Restaurants.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}